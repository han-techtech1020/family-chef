<div class="flex justify-between items-end mb-6">
  <h2 class="text-2xl font-bold text-gray-700">‰ªä„ÅÇ„ÇãÈ£üÊùê</h2>
  <%= link_to "+ ËøΩÂä†", new_stock_path, class: "bg-orange-500 text-white px-4 py-2 rounded-full shadow hover:bg-orange-600 text-sm font-bold" %>
</div>

<!-- Âú®Â∫´„Åå„Å™„ÅÑÂ†¥Âêà -->
<% if @grouped_stocks.empty? %>
  <div class="text-center py-10 text-gray-400">
    <p class="text-4xl mb-2">üßä</p>
    <p>È£üÊùê„ÅØÁ©∫„Å£„ÅΩ„Åß„Åô</p>
  </div>
<% else %>

  <!-- „Ç´„ÉÜ„Ç¥„É™„Éº„Åî„Å®„Å´„É´„Éº„Éó -->
  <!-- @category_order „Å´„ÅÇ„ÇãÈ†ÜÂ∫è„ÅßË°®Á§∫„Åó„ÄÅ„Åù„ÅÆ‰ªñ„ÅÆ„Ç´„ÉÜ„Ç¥„É™„Éº„ÅØÂæå„Çç„Å´ËøΩÂä† -->
  <% (@category_order | @grouped_stocks.keys).each do |category| %>
    
    <!-- „Åù„ÅÆ„Ç´„ÉÜ„Ç¥„É™„Éº„Å´Âú®Â∫´„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅÆ„ÅøË°®Á§∫ -->
    <% if stocks = @grouped_stocks[category] %>
      
      <!-- „Ç´„ÉÜ„Ç¥„É™„ÉºË¶ãÂá∫„Åó -->
      <h3 class="text-sm font-bold text-orange-500 mt-6 mb-2 ml-1 border-b border-orange-200 pb-1">
        <%= category %>
      </h3>

      <div class="space-y-3">
        <% stocks.each do |stock| %>
          <div class="flex items-center justify-between bg-white border border-gray-100 p-3 rounded-lg shadow-sm">
            
            <!-- ÂêçÂâç„Å®ÂÄãÊï∞ -->
            <div class="flex items-center space-x-3">
              <!-- „ÇØ„É™„ÉÉ„ÇØ„ÅßÁ∑®ÈõÜÁîªÈù¢„Å∏ -->
              <%= link_to edit_stock_path(stock), class: "flex items-center space-x-3 group" do %>
                <div class="bg-orange-50 text-orange-600 p-2 rounded-full group-hover:bg-orange-100 transition">
                  üçΩÔ∏è
                </div>
                <div>
                  <p class="font-bold text-gray-800 group-hover:text-orange-600 transition"><%= stock.ingredient.name %></p>
                  <p class="text-xs text-gray-400"><%= stock.quantity %>ÂÄã / <%= stock.storage_text %></p>
                </div>
              <% end %>
            </div>

            <!-- ÊúüÈôê„Å®ÂâäÈô§ -->
            <div class="text-right">
              <% if stock.expiration_date.present? %>
                <% is_expired = stock.expiration_date < Date.today + 3.days %>
                <p class="text-xs font-bold <%= is_expired ? 'text-red-500' : 'text-green-600' %>">
                  <%= stock.expiration_date.strftime('%m/%d') %>„Åæ„Åß
                </p>
              <% else %>
                <p class="text-xs text-gray-400">-</p>
              <% end %>
              
              <!-- ÂâäÈô§„Éú„Çø„É≥ÔºàÂ∞è„Åï„ÅèÔºâ -->
              <%= link_to stock_path(stock), data: { turbo_method: :delete }, class: "text-xs text-gray-300 hover:text-red-500 mt-1 block" do %>
                √ó
              <% end %>
            </div>

          </div>
        <% end %>
      </div>
    <% end %>
  <% end %>

<% end %>