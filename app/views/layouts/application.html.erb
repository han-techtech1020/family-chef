<!DOCTYPE html>
<html>
  <head>
    <title>FamilyChef</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

 <body class="bg-gray-50 text-gray-800 font-sans">
  
  <!-- スマホ風のコンテナ（画面中央寄せ・最大幅設定） -->
  <div class="max-w-md mx-auto min-h-screen bg-white shadow-xl flex flex-col relative">

    <!-- ヘッダー -->
    <header class="bg-orange-500 text-white p-4 sticky top-0 z-50 shadow-md flex justify-between items-center">
      <h1 class="text-xl font-bold tracking-wider">
        <%= link_to "Family Chef 👨‍🍳", root_path, class: "hover:opacity-80" %>
      </h1>
      
      <!-- ログアウトボタン（アイコン風） -->
      <% if user_signed_in? %>
        <div class="flex items-center space-x-3">
          <%= link_to edit_user_registration_path, class: "text-2xl hover:opacity-80" do %>
            ⚙️
          <% end %>
          <%= button_to "ログアウト", destroy_user_session_path, method: :delete, class: "text-xs bg-orange-600 px-2 py-1 rounded hover:bg-orange-700" %>
        </div>
      <% end %>
    </header>

    <!-- メインコンテンツ（ここに各ページが入る） -->
    <main class="flex-grow p-4 pb-20"> <!-- 下に余白を開けてボトムナビとかぶらないようにする -->
      <!-- フラッシュメッセージ（通知） -->
      <% if notice %>
        <div class="bg-green-100 border-l-4 border-green-500 text-green-700 p-3 mb-4 text-sm" role="alert">
          <%= notice %>
        </div>
      <% end %>
      <% if alert %>
        <div class="bg-red-100 border-l-4 border-red-500 text-red-700 p-3 mb-4 text-sm" role="alert">
          <%= alert %>
        </div>
      <% end %>

      <%= yield %>
    </main>

    <!-- ボトムナビゲーション（スマホアプリっぽさの要！） -->
    <% if user_signed_in? %>
      <nav class="fixed bottom-0 w-full max-w-md bg-white border-t border-gray-200 flex justify-around items-end py-2 text-xs text-gray-500 z-50">
        
        <!-- 1. 食材在庫 -->
        <%= link_to stocks_path, class: "flex flex-col items-center pb-2 w-1/4 hover:text-orange-500 #{current_page?(stocks_path) ? 'text-orange-500 font-bold' : ''}" do %>
          <span class="text-xl mb-1">🥦</span>
          <span>食材在庫</span>
        <% end %>

        <!-- 2. レシピ -->
        <%= link_to recipes_path, class: "flex flex-col items-center pb-2 w-1/4 hover:text-orange-500 #{current_page?(recipes_path) ? 'text-orange-500 font-bold' : ''}" do %>
          <span class="text-xl mb-1">📜</span>
          <span>レシピ履歴</span>
        <% end %>

        <!-- 3. 献立作成（メイン） -->
        <!-- 目立たせるスタイル -->
        <%= link_to search_recipes_path, class: "flex flex-col items-center w-1/4 relative group" do %>
          <div class="absolute -top-10 bg-orange-500 text-white rounded-full p-4 shadow-lg group-hover:bg-orange-600 group-hover:scale-105 transition border-4 border-white">
            <span class="text-2xl">🤖</span>
          </div>
          <span class="mt-8 font-bold text-orange-500">レシピ作成</span>
        <% end %>

        <!-- 4. 家族 -->
        <%= link_to family_members_path, class: "flex flex-col items-center pb-2 w-1/4 hover:text-orange-500 #{current_page?(family_members_path) ? 'text-orange-500 font-bold' : ''}" do %>
          <span class="text-xl mb-1">👨‍👩‍👧</span>
          <span>家族</span>
        <% end %>

      </nav>
    <% end %>

  </div>
</body>
</html>
